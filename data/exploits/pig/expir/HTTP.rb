require 'pp'

class PigHTTP < PigParser
        def can_parse(packet)
                return false if not packet.is_eth?
                return false if not packet.is_ip?
                return false if not packet.is_tcp?
		return false if not [80,8080,8000].include? packet.tcp_dst 
		return false if not packet.payload[0..2048] =~ /HTTP/
                return true
        end


	def parse(pkt)
		lines = pkt.payload.split("\n")
		p lines[0]
		#report_note( :host  => server,
                	#:type  => "pig.snmp",
                	#:port => 161,
                	#:proto => "udp",
                	#:data => data)

								
	end # end of parse
end

